constants: # defines the "anchors" that are used later on in this yaml file
    - &BUTTON_A 0
    - &BUTTON_B 1
    - &BUTTON_X 2
    - &BUTTON_Y 3
    - &BUTTON_LB 4
    - &BUTTON_RB 5
    - &BUTTON_BACK 6
    - &BUTTON_START 7
    - &BUTTON_XBOX 8
    - &BUTTON_LTHUMB 9
    - &BUTTON_RTHUMB 10
    - &HAT_DPAD 0
    - &HAT_DPAD_NEUTRAL 0:0:0
    - &HAT_DPAD_UP 0:0:1
    - &HAT_DPAD_DOWN 0:0:-1
    - &HAT_DPAD_DOWNRIGHT 0:1:-1
    - &HAT_DPAD_UPRIGHT 0:1:1
    - &HAT_DPAD_RIGHT 0:1:0
    - &HAT_DPAD_LEFT 0:-1:0
    - &HAT_DPAD_DOWNLEFT 0:-1:-1
    - &HAT_DPAD_UPLEFT 0:-1:1
    - &AXIS_LTHUMBX 0
    - &AXIS_LTHUMBY 1
    - &AXIS_RTHUMBX 2
    - &AXIS_RTHUMBY 3
    - &AXIS_RTRIGGER 4
    - &AXIS_LTRIGGER 5

axis_calibration:
    *AXIS_RTRIGGER: &TriggerCalibration
        min: -1.0
        max: 1.0
        uncalibrated_at_start: true
    *AXIS_LTRIGGER: *TriggerCalibration
    *AXIS_LTHUMBX: &ThumbCalibration
        <<: *TriggerCalibration
        uncalibrated_at_start: false
    *AXIS_LTHUMBY: *ThumbCalibration
    *AXIS_RTHUMBX: *ThumbCalibration
    *AXIS_RTHUMBY: *ThumbCalibration

hat_calibration:
    *HAT_DPAD:
        easy_diagonals: true

mappings:
    mode_default:
        hats:
            *HAT_DPAD_UP:
                - do: [play_scale_position, 0]
                  behavior: momentary #default
            *HAT_DPAD_DOWN:
                - do: [play_scale_position, 0]
            *HAT_DPAD_DOWNRIGHT:
                - do: [play_scale_position, 1,]
            *HAT_DPAD_UPRIGHT:
                - do: [play_scale_position, 2,]
            *HAT_DPAD_RIGHT:
                - do: [play_scale_position, 3,]
            *HAT_DPAD_LEFT:
                - do: [play_scale_position, 4,]
            *HAT_DPAD_DOWNLEFT:
                - do: [play_scale_position, 5,]
            *HAT_DPAD_UPLEFT:
                - do: [play_scale_position, 6,]
        buttons:
            *BUTTON_RB:
                - do: [set, tonic_offset, -1]
                  behavior: momentary #default
            *BUTTON_LB:
                - do: [send_cc, 64, 127] # sustain pedal
                  undo: [send_cc, 64, 0]
            *BUTTON_X:
                - do: [inc, extension_modifier, 1]
            *BUTTON_Y:
                - do: [inc, extension_modifier, 1]
            *BUTTON_A:
                - do: [set, quality_modifier, 1]
            *BUTTON_B:
                - do: [set, quality_modifier, 2]
        axes:
            *AXIS_RTRIGGER:
                - do: [set, velocity,]
                  curve: 1.7
                  value_at_min: 0x70
                  value_at_max: 0
            *AXIS_LTRIGGER:
                - do: [set, voicing,]
                  value_at_min: 0
                  value_at_max: 3
                  steps:
                      - .05
                      - .4
                      - .9
                      - 1
    mode_change_octave:
        master_button: *BUTTON_START
        master_behavior: momentary
        hats:
            *HAT_DPAD_RIGHT:
                - do: [inc, octave, 1]
                  behavior: latch
            *HAT_DPAD_LEFT:
                - do: [dec, octave, 1 ]
                  behavior: latch
    mode_change_harmony:
        master_button: *BUTTON_BACK
        master_behavior: momentary
        buttons:
            *BUTTON_A:
                - do: [set, harmony, 0] # single voice
                  behavior: latch
            *BUTTON_X:
                - do: [set, harmony, 1] # harmony a third above root
                  behavior: latch
            *BUTTON_Y:
                - do: [set, harmony, 2] # triad
                  behavior: latch
    mode_change_bass:
        master_button: *BUTTON_LTHUMB
        master_behavior: momentary
    mode_change_tonic:
        master_button: *BUTTON_RTHUMB
        master_behavior: momentary
